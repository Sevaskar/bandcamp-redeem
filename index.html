<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-GTM-TZQ6P49R"></script>
                                                                                    
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sevaskar</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: black;
      color: red;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    .banner {
      background: url('https://f4.bcbits.com/img/0037956683_100.png') no-repeat center center;
      background-size: contain;
      width: 100%;
      height: 200px;
      margin-bottom: 20px;
    }
    .player-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      padding: 20px;
    }
    .player-box {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 350px;
      background-color: #333;
      padding: 10px;
      border-radius: 10px;
      text-align: center;
    }
    .redeem-button {
      margin-top: 10px;
      background-color: red;
      color: white;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 5px;
      font-size: 16px;
      width: auto;
      display: block;
    }
    .redeem-button:hover {
      background-color: darkred;
    }
    .footer {
      margin-top: 30px;
      padding: 20px;
      background-color: #222;
      color: white;
    }
    #bandcamp-prompt {
      margin: 20px auto;
      text-align: center;
    }
    #bandcamp-prompt input {
      padding: 10px;
      width: 80%;
      max-width: 300px;
      margin-bottom: 10px;
    }
    #bandcamp-prompt button {
      padding: 10px 20px;
      background-color: red;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 5px;
    }
    #bandcamp-prompt button:hover {
      background-color: darkred;
    }

    /* Navigation Bar */
    .navbar {
      display: flex;
      justify-content: center;
      background-color: black;
      padding: 15px 0;
      gap: 20px;
    }

    /* Navigation Links */
    .nav-item {
      color: blue; /* Ensures links are blue */
      text-decoration: none;
    font-size: 18px;
      font-weight: bold;
      padding: 10px 15px;
      transition: 0.3s;
    }

    /* Initial Prompt Styling */
.prompt-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.prompt-box {
  background: #222;
  padding: 20px;
  border-radius: 10px;
  text-align: center;
  color: white;
}

.prompt-box input {
  width: 80%;
  padding: 10px;
  margin: 10px 0;
}

.prompt-links {
  display: flex;
  justify-content: center;
  gap: 20px;
}

.prompt-links a {
  color: #0f91ff;
  text-decoration: none;
  font-weight: bold;
}

.prompt-links a:hover {
  text-decoration: underline;
}
</style>
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TZQ6P49R');</script>
<!-- End Google Tag Manager -->
  
  <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';">
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TZQ6P49R"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  <div class="banner"></div>
  <!-- Initial Bandcamp URL Prompt -->
<div id="bandcamp-prompt" class="prompt-overlay">
  <div class="prompt-box">
    <p>Welcome! Please enter your Bandcamp URL.</p>
    <input type="text" id="bandcamp-url" placeholder="https://bandcamp.com/your-profile">
    <div class="prompt-links">
      <a href="#" onclick="submitBandcampURL()">Enter</a>
      <a href="https://bandcamp.com/fansignup" target="_blank">Sign Up</a>
    </div>
  </div>
</div>

<div class="navbar">
  <a href="https://sevaskar.bandcamp.com/" class="nav-item" target="_blank">Bandcamp</a>
  <a href="https://open.spotify.com/artist/1XodmhYgM6rezmNJJKwDTs?si=TVs7pxIpTKOqV97C5vDegQ" class="nav-item" target="_blank">Spotify</a>
  <a href="https://youtube.com/@sevaskar?si=svrTnQxz9Pe0Zhmd" class="nav-item" target="_blank">YouTube</a>
  <a href="https://my-store-11471314.creator-spring.com/" class="nav-item" target="_blank">Store</a>
  <a href="https://www.amazon.com/stores/Dale-R.-Witherington/author/B08X172LTG?ref=ap_rdr&isDramIntegrated=true&shoppingPortalEnabled=true&ccs_id=9d006cf8-473f-408b-bf3f-1273a1d90eb8" class="nav-item" target="_blank">Books</a>
</div>

  <div class="player-container">
    <div class="player-box">
      <iframe style="border: 0; width: 350px; height: 470px;"
          src="https://bandcamp.com/EmbeddedPlayer/album=2458287885/size=large/bgcol=333333/linkcol=0f91ff/tracklist=false/transparent=true/" seamless>
      </iframe>
      <button class="redeem-button" data-title="Pandemonium" onclick="redeemCode('Pandemonium',this)">Redeem Code</button>
    </div> <!-- Closing div added here -->

    <div class="player-box">
      <iframe style="border: 0; width: 350px; height: 470px;"
          src="https://bandcamp.com/EmbeddedPlayer/album=4130268599/size=large/bgcol=333333/linkcol=0f91ff/tracklist=false/transparent=true/" seamless>
      </iframe>
      <button class="redeem-button" data-title="Boombox" onclick="redeemCode('Boombox',this)">Redeem Code</button>
    </div>

    <div class="player-box">
      <iframe style="border: 0; width: 350px; height: 470px;"
          src="https://bandcamp.com/EmbeddedPlayer/album=3303775705/size=large/bgcol=333333/linkcol=0f91ff/tracklist=false/transparent=true/" seamless>
      </iframe>
      <button class="redeem-button" data-title="Prophet for Profit Remix" onclick="redeemCode('Prophet for Profit Remix',this)">Redeem Code</button>
    </div>

    <div class="player-box">
      <iframe style="border: 0; width: 350px; height: 470px;"
          src="https://bandcamp.com/EmbeddedPlayer/album=2582855009/size=large/bgcol=333333/linkcol=0f91ff/tracklist=false/transparent=true/" seamless>
      </iframe>
      <button class="redeem-button" data-title="Origins of Belief" onclick="redeemCode('Origins of Belief',this)">Redeem Code</button>
    </div>

    <div class="player-box">
      <iframe style="border: 0; width: 350px; height: 470px;"
          src="https://bandcamp.com/EmbeddedPlayer/track=2254569586/size=large/bgcol=333333/linkcol=0f91ff/tracklist=false/transparent=true/" seamless>
      </iframe>
      <button class="redeem-button" data-title="Vilicus" onclick="redeemCode('Vilicus',this)">Redeem Code</button>
    </div>

    <div class="player-box">
      <iframe style="border: 0; width: 350px; height: 470px;"
          src="https://bandcamp.com/EmbeddedPlayer/album=2580754490/size=large/bgcol=333333/linkcol=0f91ff/tracklist=false/transparent=true/" seamless>
      </iframe>
      <button class="redeem-button" data-title="Hiraeth" onclick="redeemCode('Hiraeth',this)">Redeem Code</button>
    </div>

    <div class="player-box">
      <iframe style="border: 0; width: 350px; height: 470px;"
          src="https://bandcamp.com/EmbeddedPlayer/album=4104591744/size=large/bgcol=333333/linkcol=0f91ff/tracklist=false/transparent=true/" seamless>
      </iframe>
      <button class="redeem-button" data-title="Machiavellian" onclick="redeemCode('Machiavellian',this)">Redeem Code</button>
    </div>

    <div class="player-box">
      <iframe style="border: 0; width: 350px; height: 470px;" 
          src="https://bandcamp.com/EmbeddedPlayer/album=2886633887/size=large/bgcol=333333/linkcol=0f91ff/tracklist=false/transparent=true/" seamless>
      </iframe>
      <button class="redeem-button" data-title="2.0" onclick="redeemCode('2.0',this)">Redeem Code</button>
    </div>

    <div class="player-box">
      <iframe style="border: 0; width: 350px; height: 470px;" 
          src="https://bandcamp.com/EmbeddedPlayer/album=3391838132/size=large/bgcol=333333/linkcol=0f91ff/tracklist=false/transparent=true/" seamless>
      </iframe>
      <button class="redeem-button" data-title="Apoplectic" onclick="redeemCode('Apoplectic', this)">Redeem Code</button>
    </div>
</div> <!-- Closing div for .player-container -->

  <form id="hidden-redeem-form" class="download-code-form" action="https://sevaskar.bandcamp.com/yum" method="get" target="_blank" style="display: none;">
    <input name="code" type="text" placeholder="e.g. lanz-gh9h" aria-label="code" /> 
    <input type="submit" value="Redeem Code" />
  </form>

  <div id="bandcampModal" style="display:none;">
  <input type="text" id="bandcamp-url" placeholder="Enter your Bandcamp URL" />
  <button onclick="saveBandcampURL()">Submit</button>
  </div>
  
<!-- Footer -->
<div class="footer">
  <a href="https://PayPal.me/sevaskar" target="_blank">
    <img src="https://raw.githubusercontent.com/Sevaskar/bandcamp-redeem/refs/heads/main/Screenshot_2025-03-25-10-57-59-353.jpg" alt="Support on PayPal" style="display: block; margin: 0 auto; max-width: 150px;">
  </a>
  <br>
  &copy; 2025 Sevaskar. All rights reserved.
</div>
<script>
  console.log("Bandcamp URL setup handled in DOMContentLoaded");
</script>
  <script src="redeem.js"></script>
  
  <script>
  document.addEventListener("DOMContentLoaded", async function () {
    const promptOverlay = document.getElementById("bandcamp-prompt");
    let bandcampURL = localStorage.getItem("bandcampURL");

    if (/^https?:\/\/[a-z0-9\-]+\.bandcamp\.com\/?$/i.test(bandcampURL)) {
      promptOverlay.style.display = "flex";
    } else {
      promptOverlay.style.display = "none";
      checkRedemptions(bandcampURL);
    }
  });

  function submitBandcampURL() {
    const url = document.getElementById("bandcamp-url").value.trim();
    if (!url.startsWith("https://bandcamp.com/")) {
      alert("Please enter a valid Bandcamp URL.");
      return;
    }
    localStorage.setItem("bandcampURL", url);
    document.getElementById("bandcamp-prompt").style.display = "none";
    checkRedemptions(url);
  }

  async function checkRedemptions(bandcampURL) {
    try {
      console.log("Checking redemptions for:", bandcampURL);
      const response = await fetch(
        'https://script.google.com/macros/s/AKfycbzJu2oR2aYGvdrmanMV5jY7fu4zzN4d_ymCLj0JmT52m0I49r3zi5-IgMnD81JwRlvp1A/exec?url=' +
        encodeURIComponent(bandcampURL)
      );

      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }

      const responseData = await response.json();
      const redeemedTitles = responseData.redeemed || [];

      document.querySelectorAll(".redeem-button").forEach(button => {
        const albumTitle = button.getAttribute("data-title");
        if (redeemedTitles.includes(albumTitle)) {
          button.disabled = true;
          button.style.cursor = "not-allowed";
          button.textContent = "Already In Collection";
          button.style.backgroundColor = "gray";
        }
      });
    } catch (error) {
      console.error("Error checking redemptions:", error);
    }
  }
</script>

  <script>
  let bandcampURL = '';

  function showModalIfNeeded() {
    if (!bandcampURL) {
      const modal = document.getElementById("bandcampModal");
      modal.style.display = "block";
    }
  }

  function saveBandcampURL() {
  const input = document.getElementById("bandcamp-url");
  bandcampURL = input.value.trim();
  const valid = /^https?:\/\/[a-z0-9\-]+\.bandcamp\.com\/?$/i.test(bandcampURL);

  if (valid) {
    document.getElementById("bandcampModal").style.display = "none";
  } else {
    alert("Please enter a valid Bandcamp URL (e.g., https://yourname.bandcamp.com).");
  }
}

  function redeemCode(release) {
    if (!bandcampURL) {
      showModalIfNeeded();
      return;
    }

    // proceed with redemption logic
    // e.g. call fetch to Google Apps Script endpoint
    console.log(`Redeeming code for ${release} with Bandcamp URL ${bandcampURL}`);
  }

  // Optionally trigger the modal on page load
  window.onload = () => {
    showModalIfNeeded();
  }
  </script>
  
</body>
</html>
